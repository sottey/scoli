<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#2f5fd3" />
  <title>Scoli</title>
  <link rel="icon" href="/favicon.ico" sizes="any" />
  <link rel="manifest" href="/manifest.json?v=6" />
  <link rel="stylesheet" href="/vendor/highlight.css" />
  <link rel="stylesheet" href="/vendor/jsuites.css" />
  <link rel="stylesheet" href="/vendor/jspreadsheet-ce.css" />
  <link rel="stylesheet" href="/vendor/jspreadsheet-themes.css" />
  <link rel="stylesheet" href="/styles.css?v=6" />
</head>
<body>
  <div id="app" class="app" data-view="split">
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">
          <div class="brand">
            <button id="brand-btn" class="brand-btn" type="button" aria-label="Reload">
              <img class="brand-logo brand-logo-light" src="/logo-light.png" alt="Scoli" />
              <img class="brand-logo brand-logo-dark" src="/logo-dark.png" alt="Scoli" />
            </button>
          </div>
          <div class="sidebar-actions">
          </div>
        </div>
        <div class="search-row">
          <input id="search-input" class="search-input" type="text" placeholder="Search notes and tasks" />
          <button id="search-btn" class="ghost icon-btn" title="Search" aria-label="Search">
            <img src="/icons/search.png" alt="" aria-hidden="true" />
          </button>
        </div>
        <div id="search-results" class="search-results hidden"></div>
      </div>
      <div id="tree-container" class="tree"></div>
      <div class="sidebar-footer">
        <button id="tree-toggle-btn" class="ghost icon-btn" title="Toggle all nodes" aria-label="Toggle all nodes">
          <img src="/icons/collapse.png" alt="" aria-hidden="true" />
        </button>
        <button id="settings-btn" class="ghost icon-btn" title="Settings" aria-label="Settings">
          <img src="/icons/settings.png" alt="" aria-hidden="true" />
        </button>
        <button id="sidebar-toggle" class="ghost icon-btn" title="Collapse sidebar" aria-label="Collapse sidebar">
          <img src="/icons/sidebar.png" alt="" aria-hidden="true" />
        </button>
      </div>
    </aside>
    <div id="sidebar-resizer" class="resizer resizer-vertical" aria-hidden="true"></div>
    <main class="main">
      <header class="main-header">
        <div class="note-info">
          <div id="note-path" class="note-path">No note selected</div>
          <button id="save-btn" class="primary" disabled>Save</button>
        </div>
        <div class="header-actions">
          <button id="scratch-btn" class="ghost icon-btn" type="button" title="Open scratch pad" aria-label="Open scratch pad">
            <img src="/icons/scratchpad.png" alt="" aria-hidden="true" />
          </button>
          <button id="move-completed-btn" class="ghost move-completed-btn" type="button" title="Move completed tasks to Done">
            Move Completed
          </button>
          <button id="date-pill" class="date-pill" type="button" title="Open today's note"></button>
          <button id="calendar-btn" class="ghost icon-btn calendar-btn" type="button" title="Open date picker" aria-label="Open date picker">
            <img src="/icons/calendar.png" alt="" aria-hidden="true" />
          </button>
          <div id="date-popover" class="date-popover hidden" role="dialog" aria-label="Pick date">
            <input id="date-picker" class="date-picker" type="date" />
          </div>
          <div class="view-selector" role="group" aria-label="View selector">
            <button class="view-btn" data-view="edit" title="Edit">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 17.25V20h2.75L17.81 8.94l-2.75-2.75L4 17.25zm15.71-9.04a1.003 1.003 0 0 0 0-1.42l-2.5-2.5a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 2.75 2.75 1.99-1.66z"/></svg>
            </button>
            <button class="view-btn" data-view="preview" title="Preview">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5c-5 0-9 4.5-10 7 1 2.5 5 7 10 7s9-4.5 10-7c-1-2.5-5-7-10-7zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>
            </button>
            <button class="view-btn" data-view="split" title="Split">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 5h7v14H4V5zm9 0h7v14h-7V5z"/></svg>
            </button>
          </div>
        </div>
      </header>
      <div id="status-banners" class="status-banners hidden">
        <div id="offline-banner" class="status-banner status-banner-offline hidden">
          <span>Server unreachable. Trying to reconnect...</span>
          <button id="offline-retry" class="ghost" type="button">Retry</button>
        </div>
        <div id="update-banner" class="status-banner status-banner-update hidden">
          <span>Update available.</span>
          <button id="update-reload" class="ghost" type="button">Reload</button>
        </div>
      </div>
      <div id="update-toast" class="update-toast hidden">Update available. Reload to apply.</div>
      <div id="app-toast" class="app-toast hidden" role="status" aria-live="polite"></div>
      <section id="main-content" class="main-content">
        <div id="editor-pane" class="pane">
          <div id="settings-panel" class="settings-panel hidden">
            <h2 class="settings-title">Settings</h2>
            <div class="settings-section">
              <div class="settings-section-header">
                <h3 class="settings-section-title">Display</h3>
                <p class="settings-section-desc">Theme and editor defaults.</p>
              </div>
              <div class="settings-grid">
                <label class="settings-row">
                  <input id="settings-dark-mode" type="checkbox" />
                  <span>Dark Mode</span>
                </label>
                <label class="settings-row">
                  <input id="settings-show-templates" type="checkbox" />
                  <span>Show Templates</span>
                </label>
                <label class="settings-row">
                  <input id="settings-show-ai-node" type="checkbox" />
                  <span>Show AI Node</span>
                </label>
                <label class="settings-field">
                  <span class="settings-label">Default View</span>
                  <select id="settings-default-view" class="settings-input">
                    <option value="edit">Edit</option>
                    <option value="preview">Preview</option>
                    <option value="split">Split</option>
                  </select>
                </label>
              </div>
            </div>
            <div class="settings-section">
              <div class="settings-section-header">
                <h3 class="settings-section-title">Notes</h3>
                <p class="settings-section-desc">Sorting for the notes tree.</p>
              </div>
              <div class="settings-grid">
                <label class="settings-field">
                  <span class="settings-label">Sort By</span>
                  <select id="settings-notes-sort-by" class="settings-input">
                    <option value="name">Name</option>
                    <option value="created">Created</option>
                    <option value="updated">Updated</option>
                  </select>
                </label>
                <label class="settings-field">
                  <span class="settings-label">Sort Order</span>
                  <select id="settings-notes-sort-order" class="settings-input">
                    <option value="asc">Ascending</option>
                    <option value="desc">Descending</option>
                  </select>
                </label>
              </div>
            </div>
            <div class="settings-section">
              <div class="settings-section-header">
                <h3 class="settings-section-title">Folders</h3>
                <p class="settings-section-desc">Startup folder selection.</p>
              </div>
              <div class="settings-grid">
                <label class="settings-field">
                  <span class="settings-label">Default Folder</span>
                  <input id="settings-default-folder" class="settings-input" type="text" placeholder="Folder/Subfolder" />
                </label>
              </div>
            </div>
            <div class="settings-section">
              <div class="settings-section-header">
                <h3 class="settings-section-title">Email</h3>
                <p class="settings-section-desc">Daily digest and due task notifications.</p>
              </div>
              <div class="settings-grid">
                <label class="settings-row">
                  <input id="email-enabled" type="checkbox" />
                  <span>Enable Email Notifications</span>
                </label>
                <label class="settings-row">
                  <input id="email-digest-enabled" type="checkbox" />
                  <span>Daily Digest</span>
                </label>
                <label class="settings-field">
                  <span class="settings-label">Digest Time</span>
                  <input id="email-digest-time" class="settings-input" type="time" />
                </label>
                <label class="settings-row">
                  <input id="email-due-enabled" type="checkbox" />
                  <span>Task Due Notification</span>
                </label>
                <label class="settings-field">
                  <span class="settings-label">Due Time</span>
                  <input id="email-due-time" class="settings-input" type="time" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">SMTP Host</span>
                  <input id="email-smtp-host" class="settings-input" type="text" placeholder="smtp.gmail.com" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">SMTP Port</span>
                  <input id="email-smtp-port" class="settings-input" type="number" min="1" max="65535" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">SMTP Username</span>
                  <input id="email-smtp-username" class="settings-input" type="email" placeholder="you@gmail.com" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">SMTP App Password</span>
                  <input id="email-smtp-password" class="settings-input" type="password" placeholder="App password" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">From Address</span>
                  <input id="email-smtp-from" class="settings-input" type="email" placeholder="you@gmail.com" />
                </label>
                <label class="settings-field">
                  <span class="settings-label">To Address</span>
                  <input id="email-smtp-to" class="settings-input" type="email" placeholder="you@gmail.com" />
                </label>
                <label class="settings-row">
                  <input id="email-smtp-tls" type="checkbox" />
                  <span>Use TLS (STARTTLS/SSL)</span>
                </label>
              </div>
              <div class="settings-actions">
                <button id="email-test-btn" class="primary" type="button">Send Test Email</button>
              </div>
            </div>
            <div class="settings-section settings-meta">
              <div class="settings-meta-row">
                <div class="settings-meta-group">
                  <div id="app-version" class="app-version"></div>
                  <div id="build-git-tag" class="app-version"></div>
                  <div id="build-docker-tag" class="app-version"></div>
                  <div id="build-commit-sha" class="app-version"></div>
                </div>
                <form id="logout-form" class="logout-form" method="post" action="/logout">
                  <button class="ghost logout-btn" type="submit" title="Log out">Log out</button>
                </form>
              </div>
            </div>
          </div>
          <textarea id="editor" class="editor" spellcheck="false"></textarea>
        </div>
        <div id="pane-resizer" class="resizer resizer-vertical" aria-hidden="true"></div>
        <div id="preview-pane" class="pane">
          <div id="asset-preview" class="asset-preview hidden"></div>
          <div id="pdf-preview" class="pdf-preview hidden"></div>
          <div id="csv-preview" class="csv-preview hidden"></div>
          <div id="sheet-panel" class="sheet-panel hidden">
            <div id="sheet-grid" class="sheet-grid"></div>
            <input id="sheet-file-input" class="hidden" type="file" accept=".csv,text/csv" />
          </div>
          <div id="preview" class="preview"></div>
          <div id="task-list" class="task-list hidden"></div>
          <div id="summary-panel" class="summary-panel hidden"></div>
          <div id="journal-panel" class="journal-panel hidden">
            <div id="journal-compose" class="journal-compose">
              <div class="journal-compose-main">
                <textarea
                  id="journal-input"
                  class="journal-input"
                  rows="3"
                  placeholder="Write a journal entry..."
                ></textarea>
                <div class="journal-compose-hint">Enter to save, Opt-Enter for a new line</div>
              </div>
              <div class="journal-compose-actions">
                <button id="journal-archive-all" class="ghost" type="button">Archive All</button>
                <button id="journal-save" class="primary" type="button">Save</button>
              </div>
            </div>
            <div id="journal-feed" class="journal-feed"></div>
          </div>
          <div id="ai-panel" class="ai-panel hidden">
            <div class="ai-toolbar">
              <div id="ai-toolbar-title" class="ai-toolbar-title">AI</div>
              <button id="ai-new-chat" class="primary" type="button">New Chat</button>
            </div>
            <div id="ai-setup-message" class="ai-setup-message hidden"></div>
            <div class="ai-body">
              <div id="ai-chat-list" class="ai-chat-list"></div>
              <div class="ai-chat-view">
                <div id="ai-archive-notice" class="ai-archive-notice hidden">
                  This chat is archived. Unarchive to continue.
                </div>
                <div id="ai-chat-messages" class="ai-chat-messages"></div>
                <div class="ai-chat-input">
                  <textarea id="ai-chat-input" class="ai-chat-textarea" rows="3" placeholder="Ask about your notes..."></textarea>
                  <button id="ai-chat-send" class="primary" type="button">Send</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <div id="tag-bar" class="tag-bar hidden">
        <button id="tag-add-btn" class="tag-add-btn" title="Add tag" aria-label="Add tag">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M11 5h2v14h-2zM5 11h14v2H5z"/>
          </svg>
        </button>
        <div id="tag-pills" class="tag-pills"></div>
      </div>
      <section id="daily-journal-panel" class="daily-journal-panel hidden" aria-label="Daily journal">
        <div class="daily-journal-header">
          <div class="daily-journal-title" id="daily-journal-title">Journal</div>
          <button id="daily-journal-new" class="ghost" type="button">New Journal Entry</button>
        </div>
        <div id="daily-journal-list" class="daily-journal-list"></div>
      </section>
    </main>
  </div>

  <div id="context-menu" class="context-menu hidden" role="menu"></div>
  <div id="whats-new-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="What's new">
    <div class="modal-backdrop" data-action="close"></div>
    <div class="modal-card scratch-modal-card" role="document">
      <div class="modal-header">
        <div class="modal-title">What's new</div>
        <button id="whats-new-close" class="ghost icon-btn" type="button" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6 6l12 12M18 6l-12 12"/>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <ul id="whats-new-list" class="whats-new-list"></ul>
      </div>
      <div class="modal-actions">
        <button id="whats-new-confirm" class="primary" type="button">Got it</button>
      </div>
    </div>
  </div>
  <div id="inbox-dialog" class="modal hidden" role="dialog" aria-modal="true" aria-label="Add to Inbox">
    <div class="modal-backdrop" data-action="close"></div>
    <div class="modal-card scratch-modal-card" role="document">
      <div class="modal-header">
        <div class="modal-title">Add to Inbox</div>
        <button id="inbox-dialog-close" class="ghost icon-btn" type="button" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6 6l12 12M18 6l-12 12"/>
          </svg>
        </button>
      </div>
      <textarea id="inbox-dialog-text" class="modal-textarea" rows="6" placeholder="Type a note, task, or markdown..."></textarea>
      <div class="modal-actions">
        <button id="inbox-dialog-cancel" class="ghost" type="button">Cancel</button>
        <button id="inbox-dialog-save" class="primary" type="button">Add</button>
      </div>
    </div>
  </div>
  <div id="scratch-dialog" class="modal hidden" role="dialog" aria-modal="true" aria-label="Scratch pad">
    <div class="modal-backdrop" data-action="close"></div>
    <div class="modal-card scratch-modal-card" role="document">
      <div class="modal-header">
        <div class="modal-title">Scratch Pad</div>
        <button id="scratch-dialog-close" class="ghost icon-btn" type="button" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <textarea id="scratch-dialog-text" class="modal-textarea" rows="12" placeholder="Jot anything here..."></textarea>
      <div class="modal-actions">
        <button id="scratch-dialog-cancel" class="ghost" type="button">Close</button>
        <button id="scratch-dialog-move" class="ghost" type="button">Move To Inbox</button>
        <button id="scratch-dialog-save" class="primary" type="button">Save</button>
      </div>
    </div>
  </div>
  <div id="task-filters-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Task filters">
    <div class="modal-backdrop" data-action="close"></div>
    <div class="modal-card scratch-modal-card" role="document">
      <div class="modal-header">
        <div class="modal-title">Task Filters</div>
        <button id="task-filters-close" class="ghost icon-btn" type="button" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <textarea id="task-filters-text" class="modal-textarea" rows="12" placeholder="Paste task filter JSON..."></textarea>
      <div class="modal-actions">
        <button id="task-filters-cancel" class="ghost" type="button">Cancel</button>
        <button id="task-filters-save" class="primary" type="button">Save</button>
      </div>
    </div>
  </div>
  <div id="command-palette" class="modal hidden" role="dialog" aria-modal="true" aria-label="Command palette">
    <div class="modal-backdrop" data-action="close"></div>
    <div class="modal-card command-card" role="document">
      <div class="modal-header">
        <div class="modal-title">Command</div>
        <button id="command-close" class="ghost icon-btn" type="button" aria-label="Close">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <input id="command-input" class="command-input" type="text" placeholder="Type a command or &gt; to search notes" autocomplete="off" />
      <div id="command-results" class="command-results"></div>
    </div>
  </div>

  <script src="/vendor/markdown-it.min.js"></script>
  <script src="/vendor/highlight.min.js"></script>
  <script src="/vendor/jsuites.js"></script>
  <script src="/vendor/jspreadsheet-ce.js"></script>
  <script src="/app.js?v=6"></script>
</body>
</html>
